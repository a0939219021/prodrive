<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>C6-LED Control (r4-iosfix1)</title>
  <style>
    body{background:#111;color:#eee;font-family:sans-serif;text-align:center}
    button{margin:10px;padding:12px 20px;border-radius:8px;border:none;background:#28a;color:#fff;font-size:16px}
    input[type=range]{width:80%}
  </style>
</head>
<body>
  <h1>C6-LED</h1>
  <button id="connect">Connect</button>
  <p>Mode: <span id="modeVal">0</span></p>
  <p><input id="bright" type="range" min="0" max="255"></p>
  <p><input id="speed" type="range" min="1" max="32"></p>

  <script>
    let device, server, service, ch_mode, ch_bright, ch_speed;

    async function connect() {
      device = await navigator.bluetooth.requestDevice({
        filters: [{ namePrefix: 'C6-LED' }],
        optionalServices: ['0000fff0-0000-1000-8000-00805f9b34fb']
      });
      server = await device.gatt.connect();
      service = await server.getPrimaryService('0000fff0-0000-1000-8000-00805f9b34fb');
      ch_mode   = await service.getCharacteristic('0000fff1-0000-1000-8000-00805f9b34fb');
      ch_bright = await service.getCharacteristic('0000fff2-0000-1000-8000-00805f9b34fb');
      ch_speed  = await service.getCharacteristic('0000fff3-0000-1000-8000-00805f9b34fb');
      console.log("Connected");
    }

    document.getElementById("connect").onclick = connect;
    document.getElementById("bright").oninput = e=>{
      if(ch_bright) ch_bright.writeValue(Uint8Array.of(e.target.value));
    };
    document.getElementById("speed").oninput = e=>{
      if(ch_speed) ch_speed.writeValue(Uint8Array.of(e.target.value));
    };
  </script>
</body>
</html>
