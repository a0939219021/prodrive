<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>BLE Click Sanity Test</title>
<body style="font-family:system-ui,Arial;padding:24px">
<h3>BLE Click Sanity Test (iOS Bluefy)</h3>
<button id="connect" style="padding:12px 16px;font-weight:700">🔗 Connect</button>
<pre id="log" style="white-space:pre-wrap;background:#111;color:#ddd;padding:10px;border-radius:8px;margin-top:12px">Ready.</pre>
<script>
function log(t){ document.getElementById('log').textContent = t; }
window.onerror = (m,s,l,c,e)=>{ log(`JS Error: ${m}`); alert(`JS Error: ${m}`); };
document.getElementById('connect').onclick = async function(){
  alert('clicked'); // 一定要先看到這個
  try{
    log('Opening chooser…');
    const dev = await navigator.bluetooth.requestDevice({
      acceptAllDevices:true,
      optionalServices:['0000fff0-0000-1000-8000-00805f9b34fb']
    });
    log('Selected: ' + (dev.name || '(no name)'));
  }catch(e){
    log('Error: ' + (e && e.message ? e.message : e));
    alert('Error: ' + (e && e.message ? e.message : e));
  }
};
if(!('bluetooth' in navigator)){
  const t='❌ 此瀏覽器未提供 Web Bluetooth。請到 iOS 設定→隱私權與安全性→藍牙→開啟 Bluefy，並確保用 Bluefy 開啟此檔。';
  log(t); alert(t);
}
</script>
